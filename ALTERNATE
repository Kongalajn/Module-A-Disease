# import
import math as m
import scipy sp
import numpy as np
from pylab pl

T=0 #Start on day 0
t=[]
Steps=400 #Days

S=[]
I=[]
R=[]

InfRate=0.9             #Infection odds on contact, beta
RecRate=0.1             #Recovery rate, alpha
VacRate=0.5             #Immunization rate, gamma
Contacts=5              #Theta contacts per time unit
Prob=Contacts*InfRate   #Transfers per time unit

PopMa=int(341457)   #Malm√∂
Inf=int(1) #Infected population, we start with 1 patient 0
Sus=int(PopMa-Inf) #Susceptible population
Rec=int(0.1*PopMa) #Recovered and immune population, includes vaccinated.

def infection(Sus, Inf, Rec, PopMa):
    for T in range(Steps):
        Sus+=int(-Prob*Sus*Inf/PopMa-VacRate*Sus)
        Inf+=int(+Prob*Sus*Inf/PopMa-RecRate*Inf)
        Rec+=int(VacRate*Sus+RecRate*Inf)

        S.append(Sus)
        I.append(Inf)
        R.append(Rec)
        t.append(T)

infection(Sus, Inf, Rec, PopMa)


figure()
plot(t,R)
